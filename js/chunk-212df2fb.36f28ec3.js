(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-212df2fb"],{"02b1":function(e,t,s){},1511:function(e,t,s){"use strict";s.r(t);var r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("Sidebar",{attrs:{"tweets-id":e.tweets.id},on:{"after-submit-tweet":e.afterSubmitTweet}}),s("section",{staticClass:"user-page"},[s("div",{staticClass:"user-wrap"},[s("Headbar",{attrs:{initialUser:e.user}}),e.isLoading?s("Spinner"):s("UserProfile",{attrs:{initialUser:e.user,"is-current-user":e.currentUser.id===e.user.id,"initial-is-following":e.user.isFollowing}}),s("div",{staticClass:"tweets-switch-tab"},e._l(e.tweetsSwitchTabs,(function(t){return s("button",{key:t.id,staticClass:"tab-item nav-item",class:{active:e.currentTab===t.mode},on:{click:function(s){return s.stopPropagation(),s.preventDefault(),e.switchTweetTab(t.mode)}}},[e._v(" "+e._s(t.title)+" ")])})),0),"tweets"===e.currentTab?s("ul",{staticClass:"tweets-list"},e._l(e.tweets,(function(e){return s("TweetsList",{key:e.id,attrs:{initinalTweet:e}})})),1):e._e(),"replied_tweets"===e.currentTab?s("ul",{staticClass:"tweets-list"},e._l(e.replies,(function(t){return s("UserRepliedList",{key:t.id,attrs:{user:e.user,initialReply:t}})})),1):e._e(),"likes"===e.currentTab?s("ul",{staticClass:"tweets-list"},e._l(e.likes,(function(t){return s("UserLikesList",{key:t.id,attrs:{user:e.user,initialLike:t}})})),1):e._e()],1)]),s("UsersTop",{on:{"after-add-follow":e.afterAddFollow,"after-delete-follow":e.afterDeleteFollow}})],1)},a=[],i=s("1da1"),n=s("5530"),o=(s("96cf"),s("b0c0"),s("2f62")),c=s("6d67"),l=s("5ea5"),u=s("3e72"),d=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"user-profile"},[r("div",{staticClass:"user-profile-head"},[r("div",{staticClass:"user-cover"},[r("img",{attrs:{src:e._f("emptyImage")(e.user.cover),alt:""}})]),r("p",{staticClass:"user-avatar avatar"},[r("img",{attrs:{src:e._f("emptyImage")(e.user.avatar),alt:""}})]),e.isCurrentUser?[r("EditProfileModal",{attrs:{"initial-user":e.user,"is-processing":e.isProcessing},on:{"after-submit":e.handleAfterSubmit}})]:r("div",[r("button",{staticClass:"btn-private-message",on:{click:e.joinPrivateMessage}},[r("img",{attrs:{src:s("a440")}})]),r("button",{staticClass:"btn-notification",on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.toggleNotification.apply(null,arguments)}}},[this.user.isSubscribing?r("img",{attrs:{src:s("3fca")}}):r("img",{attrs:{src:s("c564")}})]),this.user.isFollowing?r("button",{staticClass:"btn btn-follow",class:{"is-following":this.user.isFollowing},attrs:{type:"submit",disabled:e.isProcessing},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.deleteFollowing.apply(null,arguments)}}},[e._v(" 正在跟隨 ")]):r("button",{staticClass:"btn btn-follow",attrs:{type:"click",disabled:e.isProcessing},on:{click:function(t){return t.preventDefault(),t.stopPropagation(),e.addFollowing.apply(null,arguments)}}},[e._v(" 跟隨 ")])])],2),r("p",{staticClass:"user-info"},[r("span",{staticClass:"name"},[e._v(e._s(e.user.name))]),r("span",{staticClass:"account"},[e._v("@"+e._s(e.user.account))])]),r("div",{staticClass:"user-introduction"},[e._v(" "+e._s(e.user.introduction)+" ")]),r("div",{staticClass:"user-followships"},[r("router-link",{staticClass:"nav-item ",attrs:{to:{name:"user-followings",params:{id:e.user.id}}}},[r("div",{staticClass:"user-following"},[e._v(" "+e._s(e.user.followingNum)+" 個跟隨中 ")])]),r("router-link",{staticClass:"nav-item",attrs:{to:{name:"user-followers",params:{id:e.user.id}}}},[r("div",{staticClass:"user-follower"},[e._v(" "+e._s(e.user.followerNum)+" 位跟隨者 ")])])],1)])},p=[],m=(s("d81d"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("button",{staticClass:"btn user-edit",attrs:{type:"button","data-toggle":"modal","data-target":"#editProfileModal"},on:{click:function(t){return e.handleEditModalShow("open")}}},[e._v(" 編輯個人資料 ")]),r("div",{staticClass:"modal fade",attrs:{id:"editProfileModal","data-backdrop":"static","data-keyboard":"false",tabindex:"-1","aria-labelledby":"staticBackdropLabel","aria-hidden":"true"}},[r("div",{staticClass:"modal-dialog"},[r("form",{staticClass:"modal-content",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit.apply(null,arguments)}}},[r("div",{staticClass:"modal-header"},[r("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"},on:{click:function(t){return e.handleEditModalShow("close")}}},[r("img",{attrs:{src:s("8459"),alt:""}})]),r("p",[e._v("編輯個人資料")]),r("button",{staticClass:"btn update-profile",attrs:{type:"submit",disabled:e.isProcessing}},[e._v("儲存")])]),r("div",{staticClass:"modal-body"},[r("div",{staticClass:"user-profile-edit"},[r("div",{staticClass:"user-cover"},[e._m(0),r("input",{staticClass:"form-control-file",attrs:{id:"upload-image-cover",type:"file",name:"cover",accept:"image/*",multiple:""},on:{change:e.handleFileChange}}),r("img",{attrs:{src:e._f("emptyImage")(e.user.cover),alt:""}})]),r("div",{staticClass:"user-avatar avatar"},[e._m(1),r("input",{staticClass:"form-control-file",attrs:{id:"upload-image-avatar",type:"file",name:"avatar",accept:"image/*",multiple:""},on:{change:e.handleFileChange}}),r("img",{attrs:{src:e._f("emptyImage")(e.user.avatar),alt:""}})]),r("div",{staticClass:"user-name"},[r("label",{attrs:{for:""}},[e._v("名稱")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.user.name,expression:"user.name"}],staticClass:"user-name-input",attrs:{type:"text",name:"name",required:"",maxlength:"50"},domProps:{value:e.user.name},on:{input:function(t){t.target.composing||e.$set(e.user,"name",t.target.value)}}}),r("span",{staticClass:"text-count"},[e._v(" "+e._s(e.user.name?e.user.name.length:0)+"/50")])]),r("div",{staticClass:"user-intro"},[r("label",{attrs:{for:""}},[e._v("自我介紹")]),r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.user.introduction,expression:"user.introduction"}],staticClass:"user-intro-textarea",attrs:{name:"introduction",cols:"30",rows:"5",maxlength:"160"},domProps:{value:e.user.introduction},on:{input:function(t){t.target.composing||e.$set(e.user,"introduction",t.target.value)}}}),r("span",{staticClass:"text-count"},[e._v(e._s(e.user.introduction?e.user.introduction.length:0)+"/160")])])])])])])])])}),f=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{staticClass:"upload-image",attrs:{for:"upload-image-cover"}},[r("img",{attrs:{src:s("b1e0"),alt:""}})])},function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("label",{staticClass:"upload-image",attrs:{for:"upload-image-avatar"}},[r("img",{attrs:{src:s("b1e0"),alt:""}})])}],w=(s("d3b7"),s("3ca3"),s("ddb0"),s("2b3d"),s("2708")),v={mixins:[w["a"]],props:{initialUser:{type:Object,default:function(){return{id:0,account:"",cover:"",avatar:"",name:"",introduction:"",editModalShow:!1,isProcessing:!1}}},isProcessing:{type:Boolean,default:!1}},data:function(){return{user:Object(n["a"])({},this.initialUser)}},created:function(){this.fetchProfile()},methods:{fetchProfile:function(){this.user=Object(n["a"])({},this.initialUser)},handleFileChange:function(e){var t=e.target.files;if(e.target.matches("#upload-image-cover"))if(0===t.length)this.cover=this.user.cover;else{var s=window.URL.createObjectURL(t[0]);this.user.cover=s}else if(e.target.matches("#upload-image-avatar"))if(0===t.length)this.avatar=this.user.avatar;else{var r=window.URL.createObjectURL(t[0]);this.user.avatar=r}},handleSubmit:function(e){var t=e.target,s=new FormData(t);this.$emit("after-submit",s)},handleEditModalShow:function(e){this.user=Object(n["a"])({},this.initialUser),"open"===e?this.editModalShow=!0:"close"===e&&(this.user=Object(n["a"])({},this.initialUser),this.editModalShow=!1)}}},h=v,g=(s("a76a"),s("2877")),b=Object(g["a"])(h,m,f,!1,null,"ef8d3f36",null),k=b.exports,_=s("4cce"),y=s("2fa3"),C=s("1157"),T=s.n(C),x={mixins:[w["a"]],components:{EditProfileModal:k},props:{isCurrentUser:{type:Boolean,required:!0},initialUser:{type:Object,required:!0}},data:function(){return{user:{id:-1,account:"",name:"",email:"",introduction:"",avatar:"",cover:"",tweetNum:-1,likeNum:-1,followingNum:-1,followerNum:-1,lastLoginAt:"",isFollowing:!1,isSubscribing:!1},isProcessing:!1,isSelf:!1,socket:null,privateRoomId:0,privateRoomAwait:{}}},computed:Object(n["a"])({},Object(o["b"])(["currentUser"])),watch:{initialUser:function(e){this.user=Object(n["a"])(Object(n["a"])({},this.user),e)},privateRoomId:function(){this.privateRoomAwait={id:this.privateRoomId,userId:this.user.id,name:this.user.name,account:this.user.account,avatar:this.user.avatar},localStorage.setItem("privateRoomAwait",JSON.stringify(this.privateRoomAwait)),this.$router.push({name:"message-await",params:{id:this.privateRoomId}})}},created:function(){var e=this.$route.params.id;this.fetchUser(e),this.checkFollow(e),this.checkIsSelf()},updated:function(){this.$socket.on("join_private_room")},beforeRouteUpdate:function(e,t,s){var r=e.params.id;this.fetchUser(r),this.checkFollow(r),this.checkIsSelf(),s()},sockets:{join_private_room:function(e){this.privateRoomId=e}},methods:{fetchUser:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var r,a,i,n,o,c,l,u,d,p,m,f,w,v,h,g;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,_["a"].getUser({userId:e});case 3:if(r=s.sent,a=r.data,"error"!==a.status){s.next=7;break}throw new Error(a.message);case 7:i=a.id,n=a.account,o=a.name,c=a.email,l=a.introduction,u=a.avatar,d=a.cover,p=a.tweetNum,m=a.likeNum,f=a.followingNum,w=a.followerNum,v=a.lastLoginAt,h=a.isFollowing,g=a.isSubscribing,t.user={id:i,account:n,name:o,email:c,introduction:l,avatar:u,cover:d,tweetNum:p,likeNum:m,followingNum:f,followerNum:w,lastLoginAt:v,isFollowing:h,isSubscribing:g},s.next=16;break;case 11:s.prev=11,s.t0=s["catch"](0),console.error(s.t0.message),t.isProcessing=!1,y["a"].fire({icon:"error",title:"無法取得使用者資料，請稍後再試"});case 16:case"end":return s.stop()}}),s,null,[[0,11]])})))()},checkIsSelf:function(){this.user.id===this.currentUser.id?this.isSelf=!0:this.isSelf=!1},checkFollow:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,_["a"].getFollowings({userId:e.currentUser.id});case 3:s=t.sent,r=s.data,r.map((function(t){t===e.currentUser.id?e.isFollowing=!0:e.isFollowing=!1})),t.next=12;break;case 8:t.prev=8,t.t0=t["catch"](0),console.log(t.t0),y["a"].fire({icon:"error",title:"無法讀取跟隨狀態，請稍後再試"});case 12:case"end":return t.stop()}}),t,null,[[0,8]])})))()},addFollowing:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isProcessing=!0,t.next=4,_["a"].addFollowing({id:e.user.id});case 4:if(s=t.sent,r=s.data,"success"===r.status){t.next=8;break}throw new Error(r.message);case 8:e.user.isFollowing=!0,e.user.followerNum++,e.postTimeline(e.user.id,4,e.currentUser.id),y["a"].fire({icon:"success",title:"跟隨成功"}),e.isProcessing=!1,t.next=20;break;case 15:t.prev=15,t.t0=t["catch"](0),console.log(t.t0),y["a"].fire({icon:"error",title:"無法新增跟隨，請稍後再試"}),e.isProcessing=!1;case 20:case"end":return t.stop()}}),t,null,[[0,15]])})))()},deleteFollowing:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isProcessing=!0,t.next=4,_["a"].deleteFollowing({userId:e.user.id});case 4:if(s=t.sent,r=s.data,"error"!==r.status){t.next=8;break}throw new Error(r.message);case 8:e.user.isFollowing=!1,e.user.followerNum--,y["a"].fire({icon:"success",title:"取消跟隨"}),e.isProcessing=!1,t.next=19;break;case 14:t.prev=14,t.t0=t["catch"](0),console.error(t.t0.message),y["a"].fire({icon:"error",title:"無法取消跟隨，請稍後再試"}),e.isProcessing=!1;case 19:case"end":return t.stop()}}),t,null,[[0,14]])})))()},toggleNotification:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,_["a"].toggleNotification({id:e.user.id});case 3:if(s=t.sent,r=s.data,"success"===r.status){t.next=7;break}throw new Error(r.message);case 7:e.user.isSubscribing?(e.user.isSubscribing=!1,y["a"].fire({icon:"success",title:"取消訂閱"})):(e.user.isSubscribing=!0,y["a"].fire({icon:"success",title:"訂閱成功"})),t.next=14;break;case 10:t.prev=10,t.t0=t["catch"](0),console.log(t.t0),y["a"].fire({icon:"error",title:"目前無法訂閱，請稍後再試"});case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))()},handleAfterSubmit:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var r,a,i,n,o,c;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,t.isProcessing=!0,s.next=4,_["a"].updateUser({userId:t.user.id,formData:e});case 4:if(r=s.sent,a=r.data,"error"!==a.status){s.next=8;break}throw new Error(a.message);case 8:T()("#editProfileModal").modal("hide"),y["a"].fire({icon:"success",title:"資料更新成功"}),i=a.name,n=a.introduction,o=a.avatar,c=a.cover,t.user.name=i,t.user.introduction=n,t.user.avatar=o,t.user.cover=c,t.isProcessing=!1,s.next=23;break;case 18:s.prev=18,s.t0=s["catch"](0),console.log("error",s.t0),t.isProcessing=!1,y["a"].fire({icon:"error",title:"無法更新個人資料，請稍後再試"});case 23:case"end":return s.stop()}}),s,null,[[0,18]])})))()},joinPrivatePage:function(e){this.$socket.emit("join_private_page",{userId:e})},joinPrivateMessage:function(){var e=this.currentUser.id,t=this.user.id,s=null;this.joinPrivatePage(e),this.$socket.emit("join_private_room",{User1Id:e,User2Id:t,RoomId:s})},linkToPrivateMessage:function(){this.$router.push({name:"message-await",params:{id:this.privateRoomId}})},postTimeline:function(e,t,s){this.$socket.emit("post_timeline",{ReceiverId:e,type:t,PostId:s})}}},R=x,P=(s("16c0"),s("fea3"),Object(g["a"])(R,d,p,!1,null,"f64a3d82",null)),L=P.exports,U=s("7e75"),j=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"tweet"},[r("div",{staticClass:"tweet-wrap"},[r("div",{staticClass:"replied-tweet"},[r("router-link",{staticClass:"avatar",attrs:{to:{name:"user",params:{id:e.reply.RepliedTweet.Author.id}}}},[r("img",{attrs:{src:e._f("emptyImage")(e.reply.RepliedTweet.Author.avatar),alt:""}})]),r("div",{staticClass:"tweet-info"},[r("div",{staticClass:"user-info"},[r("router-link",{staticClass:"name",attrs:{to:{name:"user",params:{id:e.reply.RepliedTweet.Author.id}}}},[e._v(" "+e._s(e.reply.RepliedTweet.Author.name)+" ")]),r("span",{staticClass:"account"},[e._v("@"+e._s(e.reply.RepliedTweet.Author.account))]),r("span",{staticClass:"tweet-update-at"},[e._v("・"+e._s(e._f("fromNow")(e.reply.RepliedTweet.createdAt)))])],1),r("div",{staticClass:"tweet-content"},[e._v(" "+e._s(e.reply.RepliedTweet.description)+" ")]),r("div",{staticClass:"tweet-panel"},[r("button",{staticClass:"tweet-reply-action",attrs:{type:"button","data-toggle":"modal","data-target":"#replyTweetModal-"+e.reply.id},on:{click:e.handleReplyTweetModal}},[r("img",{attrs:{src:s("2765"),alt:""}}),r("span",[e._v(e._s(e.reply.RepliedTweet.replyNum))])]),e.reply.RepliedTweet.isLike?r("button",{staticClass:"likes",class:{"is-like":e.reply.RepliedTweet.isLike},attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.deleteLike(e.reply.TweetId)}}},[r("img",{attrs:{src:s("bea5"),alt:""}}),r("span",[e._v(e._s(e.reply.RepliedTweet.likeNum))])]):r("button",{staticClass:"likes",attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.addLike(e.reply.TweetId)}}},[r("img",{attrs:{src:s("ce3b"),alt:""}}),r("span",[e._v(e._s(e.reply.RepliedTweet.likeNum))])])])])],1),r("div",{staticClass:"tweet-replied"},[r("router-link",{staticClass:"avatar",attrs:{to:{name:"user",params:{id:e.user.id}}}},[r("img",{attrs:{src:e._f("emptyImage")(e.user.avatar),alt:""}})]),r("div",{staticClass:"tweet-info"},[r("div",{staticClass:"user-info"},[r("a",{staticClass:"name",attrs:{href:""}},[e._v(e._s(e.user.name))]),r("span",{staticClass:"account"},[e._v("@"+e._s(e.user.account))]),r("span",{staticClass:"tweet-update-at"},[e._v("・"+e._s(e._f("fromNow")(e.reply.createdAt)))])]),r("div",{staticClass:"tweet-content"},[e._v(" "+e._s(e.reply.comment)+" ")])])],1)]),e.isShowReplyModal?r("div",{staticClass:"modal fade",attrs:{id:"replyTweetModal-"+e.reply.id,tabindex:"-1","aria-labelledby":"replyTweetModalLabel","aria-hidden":"true"}},[r("ReplyTweetModal2",{attrs:{reply:e.reply},on:{"after-create-comment":e.afterCreateComment}})],1):e._e(),r("div",{staticClass:"full-link",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.linkToTweetDetail(e.reply.TweetId)}}})])},I=[],O=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"modal-dialog"},[s("div",{staticClass:"modal-content"},[e._m(0),s("div",{staticClass:"modal-body"},[s("div",{staticClass:"tweet"},[s("a",{staticClass:"avatar",attrs:{href:""}},[s("img",{attrs:{src:e._f("emptyImage")(e.reply.RepliedTweet.Author.avatar),alt:""}})]),s("div",{staticClass:"tweet-info"},[s("div",{staticClass:"user-info"},[s("a",{staticClass:"name",attrs:{href:""}},[e._v(e._s(e.reply.RepliedTweet.Author.name))]),s("span",{staticClass:"account"},[e._v("@"+e._s(e.reply.RepliedTweet.Author.account))]),s("span",{staticClass:"tweet-update-at"},[e._v("・"+e._s(e._f("fromNow")(e.reply.createdAt)))])]),s("div",{staticClass:"tweet-content"},[e._v(" "+e._s(e.reply.RepliedTweet.description)+" ")]),s("div",{staticClass:"tweet-reply-to"},[e._v("回覆給"),s("span",[e._v("@"+e._s(e.reply.RepliedTweet.Author.account))])])])]),s("form",{staticClass:"reply-tweet",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit(e.reply)}}},[s("div",{staticClass:"reply-tweet-wrap"},[s("span",{staticClass:"avatar",attrs:{href:""}},[s("img",{attrs:{src:e._f("emptyImage")(e.currentUser.avatar),alt:""}})]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.comment,expression:"comment"}],staticClass:"reply-textarea",attrs:{name:"comment",id:"",cols:"30",rows:"5",maxlength:"140",placeholder:"推你的回覆"},domProps:{value:e.comment},on:{input:function(t){t.target.composing||(e.comment=t.target.value)}}})]),s("button",{staticClass:"btn reply-button",attrs:{type:"submit",disabled:e.isProcessing}},[e._v(" "+e._s(e.isProcessing?"回覆中...":"回覆")+" ")])])])])])},N=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"modal-header"},[r("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[r("img",{attrs:{src:s("8459"),alt:""}})])])}],S=(s("498a"),s("6783")),A={mixins:[w["c"],w["a"]],props:{reply:{type:Object,required:!0}},computed:Object(n["a"])({},Object(o["b"])(["currentUser"])),data:function(){return{comment:"",isProcessing:!1}},methods:{handleSubmit:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var r,a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(s.prev=0,t.comment.trim()){s.next=4;break}return y["a"].fire({icon:"warning",title:"您的回覆未填寫任何內容"}),s.abrupt("return");case 4:return t.isProcessing=!0,s.next=7,S["a"].createTweetReply({tweetId:e.TweetId,comment:t.comment});case 7:if(r=s.sent,a=r.data,"error"!==a.status){s.next=11;break}throw new Error(a.message);case 11:t.$emit("after-create-comment",{tweetId:e.TweetId,authorId:e.UserId,replyId:a.Reply.id,replyNum:e.RepliedTweet.replyNum}),T()("#replyTweetModal-".concat(e.id)).modal("hide"),y["a"].fire({icon:"success",title:"回覆推文成功"}),t.isProcessing=!1,t.comment="",s.next=22;break;case 18:s.prev=18,s.t0=s["catch"](0),console.error(s.t0.response),y["a"].fire({icon:"warning",title:"無法新增回覆，請稍候在試"});case 22:case"end":return s.stop()}}),s,null,[[0,18]])})))()}}},$=A,M=(s("a186"),Object(g["a"])($,O,N,!1,null,"fe7baccc",null)),E=M.exports,F={mixins:[w["c"],w["a"]],components:{ReplyTweetModal2:E},props:{user:{type:Object,required:!0},initialReply:{type:Object,required:!0}},data:function(){return{reply:this.initialReply,isShowReplyModal:!1,isProcessing:!1}},computed:Object(n["a"])({},Object(o["b"])(["currentUser"])),watch:{initialReply:function(e){this.reply=Object(n["a"])(Object(n["a"])({},this.reply),e)}},methods:{addLike:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var r,a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,t.isProcessing=!0,s.next=4,S["a"].addLike({tweetId:e});case 4:if(r=s.sent,a=r.data,"success"===a.status){s.next=8;break}throw new Error(a.message);case 8:t.reply.RepliedTweet.isLike=!0,t.reply.RepliedTweet.likeNum+=1,t.currentUser.id!==t.reply.RepliedTweet.Author.id&&t.postTimeline(t.reply.RepliedTweet.Author.id,3,a.Like.id),y["a"].fire({icon:"success",title:"加入喜歡！"}),t.isProcessing=!1,s.next=20;break;case 15:s.prev=15,s.t0=s["catch"](0),console.log(s.t0),y["a"].fire({icon:"error",title:"無法加入喜歡，請稍後再試"}),t.isProcessing=!1;case 20:case"end":return s.stop()}}),s,null,[[0,15]])})))()},deleteLike:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var r,a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,t.isProcessing=!0,s.next=4,S["a"].deleteLike({tweetId:e});case 4:if(r=s.sent,a=r.data,"success"===a.status){s.next=8;break}throw new Error(a.message);case 8:t.reply.RepliedTweet.isLike=!1,t.reply.RepliedTweet.likeNum-=1,y["a"].fire({icon:"success",title:"收回喜歡！"}),t.isProcessing=!1,s.next=19;break;case 14:s.prev=14,s.t0=s["catch"](0),console.log(s.t0),y["a"].fire({icon:"error",title:"無法收回喜歡，請稍後再試"}),t.isProcessing=!1;case 19:case"end":return s.stop()}}),s,null,[[0,14]])})))()},afterCreateComment:function(e){var t=e.authorId,s=e.replyId;this.reply.RepliedTweet.replyNum+=1,this.currentUser.id!==t&&this.postTimeline(t,2,s)},handleReplyTweetModal:function(){this.isShowReplyModal=!0},linkToTweetDetail:function(e){this.$router.push("/tweets/".concat(e))},postTimeline:function(e,t,s){this.$socket.emit("post_timeline",{ReceiverId:e,type:t,PostId:s})}}},D=F,q=(s("aa32"),Object(g["a"])(D,j,I,!1,null,"82e6cf50",null)),B=q.exports,J=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("li",{staticClass:"tweet"},[r("router-link",{staticClass:"avatar",attrs:{to:{name:"user",params:{id:e.like.LikedTweet.Author.id}}}},[r("img",{attrs:{src:e._f("emptyImage")(e.like.LikedTweet.Author.avatar),alt:""}})]),r("div",{staticClass:"tweet-info"},[r("div",{staticClass:"user-info"},[r("router-link",{staticClass:"name",attrs:{to:{name:"user",params:{id:e.like.LikedTweet.Author.id}}}},[e._v(" "+e._s(e.like.LikedTweet.Author.name)+" ")]),r("span",{staticClass:"account"},[e._v("@"+e._s(e.like.LikedTweet.Author.account))]),r("span",{staticClass:"tweet-update-at"},[e._v("・"+e._s(e._f("fromNow")(e.like.LikedTweet.createdAt)))])],1),r("div",{staticClass:"tweet-content"},[e._v(" "+e._s(e.like.LikedTweet.description)+" ")]),r("div",{staticClass:"tweet-panel"},[r("button",{staticClass:"tweet-reply-action",attrs:{type:"button","data-toggle":"modal","data-target":"#replyTweetModal-"+e.like.id},on:{click:e.handleReplyTweetModal}},[r("img",{attrs:{src:s("2765"),alt:""}}),r("span",[e._v(e._s(e.like.LikedTweet.replyNum))])]),e.like.LikedTweet.isLike?r("button",{staticClass:"likes",class:{"is-like":e.like.LikedTweet.isLike},attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.deleteLike(e.like.LikedTweet.id)}}},[r("img",{attrs:{src:s("bea5"),alt:""}}),r("span",[e._v(e._s(e.like.LikedTweet.likeNum))])]):r("button",{staticClass:"likes",attrs:{type:"button"},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.addLike(e.like.LikedTweet.id)}}},[r("img",{attrs:{src:s("ce3b"),alt:""}}),r("span",[e._v(e._s(e.like.LikedTweet.likeNum))])])])]),e.isShowReplyModal?r("div",{staticClass:"modal fade",attrs:{id:"replyTweetModal-"+e.like.id,tabindex:"-1","aria-labelledby":"replyTweetModalLabel","aria-hidden":"true"}},[r("ReplyTweetModal3",{attrs:{like:e.like},on:{"after-create-comment":e.afterCreateComment}})],1):e._e(),r("div",{staticClass:"full-link",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.linkToTweetDetail(e.like.TweetId)}}})],1)},H=[],z=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"modal-dialog"},[s("div",{staticClass:"modal-content"},[e._m(0),s("div",{staticClass:"modal-body"},[s("div",{staticClass:"tweet"},[s("a",{staticClass:"avatar",attrs:{href:""}},[s("img",{attrs:{src:e._f("emptyImage")(e.like.LikedTweet.Author.avatar),alt:""}})]),s("div",{staticClass:"tweet-info"},[s("div",{staticClass:"user-info"},[s("a",{staticClass:"name",attrs:{href:""}},[e._v(e._s(e.like.LikedTweet.Author.name))]),s("span",{staticClass:"account"},[e._v("@"+e._s(e.like.LikedTweet.Author.account))]),s("span",{staticClass:"tweet-update-at"},[e._v("・"+e._s(e._f("fromNow")(e.like.createdAt)))])]),s("div",{staticClass:"tweet-content"},[e._v(" "+e._s(e.like.LikedTweet.description)+" ")]),s("div",{staticClass:"tweet-reply-to"},[e._v("回覆給"),s("span",[e._v("@"+e._s(e.like.LikedTweet.Author.account))])])])]),s("form",{staticClass:"reply-tweet",on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.handleSubmit(e.like)}}},[s("div",{staticClass:"reply-tweet-wrap"},[s("span",{staticClass:"avatar",attrs:{href:""}},[s("img",{attrs:{src:e._f("emptyImage")(e.currentUser.avatar),alt:""}})]),s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.comment,expression:"comment"}],staticClass:"reply-textarea",attrs:{name:"comment",id:"",cols:"30",rows:"5",maxlength:"140",placeholder:"推你的回覆"},domProps:{value:e.comment},on:{input:function(t){t.target.composing||(e.comment=t.target.value)}}})]),s("button",{staticClass:"btn reply-button",attrs:{type:"submit",disabled:e.isProcessing}},[e._v(" "+e._s(e.isProcessing?"回覆中...":"回覆")+" ")])])])])])},G=[function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"modal-header"},[r("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[r("img",{attrs:{src:s("8459"),alt:""}})])])}],K={mixins:[w["c"],w["a"]],props:{like:{type:Object,required:!0}},computed:Object(n["a"])({},Object(o["b"])(["currentUser"])),data:function(){return{comment:"",isProcessing:!1}},methods:{handleSubmit:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var r,a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:if(s.prev=0,t.comment.trim()){s.next=4;break}return y["a"].fire({icon:"warning",title:"您的回覆未填寫任何內容"}),s.abrupt("return");case 4:return t.isProcessing=!0,s.next=7,S["a"].createTweetReply({tweetId:e.TweetId,comment:t.comment});case 7:if(r=s.sent,a=r.data,"error"!==a.status){s.next=11;break}throw new Error(a.message);case 11:t.$emit("after-create-comment",{tweetId:e.TweetId,authorId:e.UserId,replyId:a.Reply.id,replyNum:e.LikedTweet.likeNum}),T()("#replyTweetModal-".concat(e.id)).modal("hide"),y["a"].fire({icon:"success",title:"回覆推文成功"}),t.isProcessing=!1,t.comment="",s.next=22;break;case 18:s.prev=18,s.t0=s["catch"](0),console.error(s.t0.response),y["a"].fire({icon:"warning",title:"無法新增回覆，請稍候在試"});case 22:case"end":return s.stop()}}),s,null,[[0,18]])})))()}}},Q=K,V=(s("6223"),Object(g["a"])(Q,z,G,!1,null,"34d1a000",null)),W=V.exports,X={mixins:[w["c"],w["a"]],components:{ReplyTweetModal3:W},props:{user:{type:Object,required:!0},initialLike:{type:Object,required:!0}},data:function(){return{like:this.initialLike,isShowReplyModal:!1,isProcessing:!1}},computed:Object(n["a"])({},Object(o["b"])(["currentUser"])),watch:{initialLike:function(e){this.like=Object(n["a"])(Object(n["a"])({},this.like),e)}},methods:{addLike:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var r,a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,t.isProcessing=!0,s.next=4,S["a"].addLike({tweetId:e});case 4:if(r=s.sent,a=r.data,"success"===a.status){s.next=8;break}throw new Error(a.message);case 8:t.like.LikedTweet.isLike=!0,t.like.LikedTweet.likeNum+=1,t.currentUser.id!==t.like.LikedTweet.Author.id&&t.postTimeline(t.like.LikedTweet.Author.id,3,a.Like.id),y["a"].fire({icon:"success",title:"加入喜歡！"}),t.isProcessing=!1,s.next=20;break;case 15:s.prev=15,s.t0=s["catch"](0),console.log(s.t0.response),y["a"].fire({icon:"error",title:"無法加入喜歡，請稍後再試"}),t.isProcessing=!1;case 20:case"end":return s.stop()}}),s,null,[[0,15]])})))()},deleteLike:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var r,a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,t.isProcessing=!0,s.next=4,S["a"].deleteLike({tweetId:e});case 4:if(r=s.sent,a=r.data,"success"===a.status){s.next=8;break}throw new Error(a.message);case 8:t.like.LikedTweet.isLike=!1,t.like.LikedTweet.likeNum-=1,y["a"].fire({icon:"success",title:"收回喜歡！"}),t.isProcessing=!1,s.next=19;break;case 14:s.prev=14,s.t0=s["catch"](0),console.log(s.t0.response),y["a"].fire({icon:"error",title:"無法收回喜歡，請稍後再試"}),t.isProcessing=!1;case 19:case"end":return s.stop()}}),s,null,[[0,14]])})))()},afterCreateComment:function(e){var t=e.authorId,s=e.replyId;this.like.LikedTweet.replyNum+=1,this.currentUser.id!==t&&this.postTimeline(t,2,s)},handleReplyTweetModal:function(){this.isShowReplyModal=!0},linkToTweetDetail:function(e){this.$router.push("/tweets/".concat(e))},postTimeline:function(e,t,s){this.$socket.emit("post_timeline",{ReceiverId:e,type:t,PostId:s})}}},Y=X,Z=(s("f0d4"),Object(g["a"])(Y,J,H,!1,null,"2ec32052",null)),ee=Z.exports,te=s("2375"),se={name:"User",components:{Headbar:c["a"],Sidebar:l["a"],UsersTop:u["a"],UserProfile:L,TweetsList:U["a"],UserRepliedList:B,UserLikesList:ee,Spinner:te["a"]},data:function(){return{user:{id:-1,account:"",name:"",email:"",introduction:"",avatar:"",cover:"",tweetNum:-1,likeNum:-1,followingNum:-1,followerNum:-1,lastLoginAt:"",isFollowing:!1},tweets:[],replies:[],likes:[],tweetsSwitchTabs:[{id:1,mode:"tweets",title:"推文"},{id:2,mode:"replied_tweets",title:"推文與回覆"},{id:3,mode:"likes",title:"喜歡的內容"}],currentTab:"tweets",isLoading:!0}},computed:Object(n["a"])({},Object(o["b"])(["currentUser"])),watch:{initialUser:function(e){this.user=Object(n["a"])(Object(n["a"])({},this.user),e)}},created:function(){var e=this.$route.params.id;this.fetchUser(e),this.fetchUserTweets(e),this.fetchUserRepliedTweets(e),this.fetchUserLikes(e)},beforeRouteUpdate:function(e,t,s){var r=e.params.id;this.fetchUser(r),this.fetchUserTweets(r),this.fetchUserRepliedTweets(r),this.fetchUserLikes(r),s()},methods:{fetchUser:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var r,a,i,n,o,c,l,u,d,p,m,f,w,v,h;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,_["a"].getUser({userId:e});case 3:if(r=s.sent,a=r.data,"error"!==a.status){s.next=7;break}throw new Error(a.message);case 7:i=a.id,n=a.account,o=a.name,c=a.email,l=a.introduction,u=a.avatar,d=a.cover,p=a.tweetNum,m=a.likeNum,f=a.followingNum,w=a.followerNum,v=a.lastLoginAt,h=a.isFollowing,t.user={id:i,account:n,name:o,email:c,introduction:l,avatar:u,cover:d,tweetNum:p,likeNum:m,followingNum:f,followerNum:w,lastLoginAt:v,isFollowing:h},t.isLoading=!1,s.next=18;break;case 12:s.prev=12,s.t0=s["catch"](0),t.isLoading=!1,console.error(s.t0.message),t.isProcessing=!1,y["a"].fire({icon:"error",title:"無法取得使用者資料，請稍後再試"});case 18:case"end":return s.stop()}}),s,null,[[0,12]])})))()},fetchUserTweets:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var r,a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,_["a"].getUserTweets({userId:e,offset:0,limit:100});case 3:if(r=s.sent,a=r.data,"error"!==a.status){s.next=7;break}throw new Error(a.message);case 7:t.tweets=Object(n["a"])({},a),s.next=15;break;case 10:s.prev=10,s.t0=s["catch"](0),console.error(s.t0.message),t.isProcessing=!1,y["a"].fire({icon:"error",title:"無法取得使用者資料，請稍後再試"});case 15:case"end":return s.stop()}}),s,null,[[0,10]])})))()},fetchUserRepliedTweets:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var r,a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,_["a"].getUserRepliedTweets({userId:e,offset:0,limit:100});case 3:if(r=s.sent,a=r.data,"error"!==a.status){s.next=7;break}throw new Error(a.message);case 7:t.replies=Object(n["a"])({},a),s.next=15;break;case 10:s.prev=10,s.t0=s["catch"](0),console.error(s.t0.message),t.isProcessing=!1,y["a"].fire({icon:"error",title:"無法取得使用者資料，請稍後再試"});case 15:case"end":return s.stop()}}),s,null,[[0,10]])})))()},fetchUserLikes:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){var r,a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,_["a"].getUserLikes({userId:e,offset:0,limit:100});case 3:if(r=s.sent,a=r.data,"error"!==a.status){s.next=7;break}throw new Error(a.message);case 7:t.likes=Object(n["a"])({},a),s.next=15;break;case 10:s.prev=10,s.t0=s["catch"](0),console.error(s.t0.message),t.isProcessing=!1,y["a"].fire({icon:"error",title:"無法取得使用者資料，請稍後再試"});case 15:case"end":return s.stop()}}),s,null,[[0,10]])})))()},handleAfterSubmitReply:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,e.text){t.next=4;break}return y["a"].fire({icon:"warning",title:"您尚未填寫任何評論"}),t.abrupt("return");case 4:return e.isProcessing=!0,t.next=7,S["a"].createTweetReply({restaurantId:e.restaurantId,text:e.text});case 7:if(s=t.sent,r=s.data,"error"!==r.status){t.next=11;break}throw new Error(r.message);case 11:e.$emit("after-create-comment",{commentId:r.commentId,restaurantId:e.restaurantId,text:e.text}),e.isProcessing=!1,e.text="",t.next=21;break;case 16:t.prev=16,t.t0=t["catch"](0),console.error(t.t0.message),e.isProcessing=!1,y["a"].fire({icon:"error",title:"無法新增評論，請稍後再試"});case 21:case"end":return t.stop()}}),t,null,[[0,16]])})))()},switchTweetTab:function(e){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function s(){return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:s.prev=0,s.t0=e,s.next="tweets"===s.t0?4:"replied_tweets"===s.t0?7:"likes"===s.t0?10:13;break;case 4:return t.currentTab=e,t.$router.push({name:"user",params:{id:t.user.id}}),s.abrupt("break",13);case 7:return t.currentTab=e,t.$router.push({name:"user-replied-tweets",params:{id:t.user.id}}),s.abrupt("break",13);case 10:return t.currentTab=e,t.$router.push({name:"user-likes-tweets",params:{id:t.user.id}}),s.abrupt("break",13);case 13:s.next=19;break;case 15:s.prev=15,s.t1=s["catch"](0),t.isProcessing=!1,y["a"].fire({icon:"error",title:"無法更新個人資料，請稍後再試"});case 19:case"end":return s.stop()}}),s,null,[[0,15]])})))()},afterSubmitTweet:function(){var e=this.$route.params.id;this.fetchUserTweets(e)},afterAddFollow:function(){var e=this.$route.params.id;this.fetchUser(e)},afterDeleteFollow:function(){var e=this.$route.params.id;this.fetchUser(e)}}},re=se,ae=(s("855b"),s("e9fb"),Object(g["a"])(re,r,a,!1,null,"79a203eb",null));t["default"]=ae.exports},"16c0":function(e,t,s){"use strict";s("a1f3")},"2c21":function(e,t,s){},"2f50":function(e,t,s){"use strict";s("02b1")},"3fca":function(e,t,s){e.exports=s.p+"img/icon_notification-2.47213e13.svg"},6223:function(e,t,s){"use strict";s("e4d7")},"6d67":function(e,t,s){"use strict";var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("h2",{staticClass:"headbar"},[r("button",{staticClass:"back",on:{click:function(t){return e.$router.back()}}},[r("img",{attrs:{src:s("8480"),alt:""}})]),r("router-link",{directives:[{name:"show",rawName:"v-show",value:e.user.name,expression:"user.name"}],staticClass:"title",attrs:{to:{name:"user",params:{id:e.user.id}}}},[r("div",{staticClass:"main-title"},[e._v(e._s(e.user.name))]),r("div",{staticClass:"sub-title"},[e._v(e._s(e.user.tweetNum)+" 推文")])])],1)},a=[],i=s("5530"),n={props:{initialUser:{type:Object,required:!0}},data:function(){return{user:this.initialUser}},watch:{initialUser:function(e){this.user=Object(i["a"])(Object(i["a"])({},this.user),e)}}},o=n,c=(s("2f50"),s("2877")),l=Object(c["a"])(o,r,a,!1,null,"1184a62f",null);t["a"]=l.exports},"6e30":function(e,t,s){},8480:function(e,t,s){e.exports=s.p+"img/icon_back.59e5a2e5.svg"},"855b":function(e,t,s){"use strict";s("2c21")},8664:function(e,t,s){},a17d:function(e,t,s){},a186:function(e,t,s){"use strict";s("8664")},a1f3:function(e,t,s){},a440:function(e,t,s){e.exports=s.p+"img/icon_message.64e01f65.svg"},a76a:function(e,t,s){"use strict";s("a17d")},aa32:function(e,t,s){"use strict";s("c475")},b1e0:function(e,t,s){e.exports=s.p+"img/icon_upload.1c8d2d92.svg"},bb2c:function(e,t,s){},be1d:function(e,t,s){},c475:function(e,t,s){},c564:function(e,t,s){e.exports=s.p+"img/icon_notification-1.fd7763e3.svg"},e4d7:function(e,t,s){},e9fb:function(e,t,s){"use strict";s("6e30")},f0d4:function(e,t,s){"use strict";s("bb2c")},fea3:function(e,t,s){"use strict";s("be1d")}}]);
//# sourceMappingURL=chunk-212df2fb.36f28ec3.js.map