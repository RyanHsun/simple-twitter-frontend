(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-54b9b808"],{"02b1":function(e,t,s){},"2f50":function(e,t,s){"use strict";s("02b1")},"4aa9":function(e,t,s){"use strict";s("5434")},5434:function(e,t,s){},"5fae":function(e,t,s){"use strict";s("8d5d")},"6d67":function(e,t,s){"use strict";var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("h2",{staticClass:"headbar"},[i("button",{staticClass:"back",on:{click:function(t){return e.$router.back()}}},[i("img",{attrs:{src:s("8480"),alt:""}})]),i("router-link",{directives:[{name:"show",rawName:"v-show",value:e.user.name,expression:"user.name"}],staticClass:"title",attrs:{to:{name:"user",params:{id:e.user.id}}}},[i("div",{staticClass:"main-title"},[e._v(e._s(e.user.name))]),i("div",{staticClass:"sub-title"},[e._v(e._s(e.user.tweetNum)+" 推文")])])],1)},r=[],n=s("5530"),o={props:{initialUser:{type:Object,required:!0}},data:function(){return{user:this.initialUser}},watch:{initialUser:function(e){this.user=Object(n["a"])(Object(n["a"])({},this.user),e)}}},a=o,l=(s("2f50"),s("2877")),c=Object(l["a"])(a,i,r,!1,null,"1184a62f",null);t["a"]=c.exports},8480:function(e,t,s){e.exports=s.p+"img/icon_back.59e5a2e5.svg"},"8d5d":function(e,t,s){},e85a:function(e,t,s){"use strict";s.r(t);var i=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"container"},[s("Sidebar"),s("section",{staticClass:"user-followships"},[s("div",{staticClass:"user-wrap"},[s("div",{staticClass:"headbar-wrap"},[s("Headbar",{attrs:{"initial-user":e.user}}),s("div",{staticClass:"user-followships-tab"},[s("div",{staticClass:"user-followships-followers"},[s("router-link",{staticClass:"nav-item",attrs:{to:{name:"user-followers",params:{id:e.user.id}}}},[e._v("跟隨者")])],1),s("div",{staticClass:"user-followships-followings active"},[s("router-link",{staticClass:"nav-item",attrs:{to:{name:"user-followings",params:{id:e.user.id}}}},[e._v("正在跟隨")])],1)])],1),e._l(e.followingUsers,(function(e){return s("UserFollowingsCard",{key:e.id,attrs:{initinalFollowingUser:e}})}))],2)]),s("UsersTop")],1)},r=[],n=s("5530"),o=s("1da1"),a=(s("96cf"),s("b0c0"),s("6d67")),l=s("5ea5"),c=s("3e72"),u=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"followships-list"},[s("li",{staticClass:"followships-item"},[s("router-link",{staticClass:"followships-avatar avatar",attrs:{to:{name:"user",params:{id:e.followingUser.followingId}}}},[s("img",{attrs:{src:e._f("emptyImage")(e.followingUser.following.avatar),alt:""}})]),s("div",{staticClass:"followships-content"},[s("router-link",{staticClass:"followships-info",attrs:{to:{name:"user",params:{id:e.followingUser.followingId}}}},[s("span",{staticClass:"name"},[e._v(e._s(e.followingUser.following.name))]),s("span",{staticClass:"account"},[e._v("@"+e._s(e.followingUser.following.account))])]),e.followingUser.following.isFollowing?s("button",{staticClass:"btn toggle-follow is-following",attrs:{disabled:e.isProcessing},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.deleteFollowing(e.followingUser.followingId)}}},[e._v(" 正在跟隨 ")]):s("button",{staticClass:"btn toggle-follow",attrs:{disabled:e.isProcessing},on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.addFollowing.apply(null,arguments)}}},[e._v(" 跟隨 ")]),s("div",{staticClass:"followships-intro"},[e._v(" "+e._s(e.followingUser.following.introduction)+" ")])],1),s("div",{staticClass:"full-link",on:{click:function(t){return t.stopPropagation(),t.preventDefault(),e.linkToUserProfile(e.followingUser.followingId)}}})],1)])},f=[],w=s("2f62"),g=s("2708"),d=s("4cce"),p=s("2fa3"),m={mixins:[g["a"]],props:{initinalFollowingUser:{type:Object,require:!0}},data:function(){return{followingUser:this.initinalFollowingUser,isProcessing:!1}},computed:Object(n["a"])({},Object(w["b"])(["currentUser"])),methods:{deleteFollowing:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function s(){var i,r;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,t.isProcessing=!0,s.next=4,d["a"].deleteFollowing({userId:e});case 4:if(i=s.sent,r=i.data,"success"===r.status){s.next=8;break}throw new Error(r.message);case 8:t.followingUser.following.isFollowing=!1,p["a"].fire({icon:"success",title:"取消跟隨"}),t.isProcessing=!1,s.next=18;break;case 13:s.prev=13,s.t0=s["catch"](0),t.isProcessing=!1,p["a"].fire({icon:"error",title:"無法取消跟隨，請稍後再試"}),console.log("error",s.t0);case 18:case"end":return s.stop()}}),s,null,[[0,13]])})))()},addFollowing:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var s,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,e.isProcessing=!0,t.next=4,d["a"].addFollowing({id:e.followingUser.followingId});case 4:if(s=t.sent,i=s.data,"success"===i.status){t.next=8;break}throw new Error(i.message);case 8:e.followingUser.following.isFollowing=!0,e.postTimeline(e.followingUser.followingId,4,e.currentUser.id),p["a"].fire({icon:"success",title:"跟隨成功"}),e.isProcessing=!1,t.next=18;break;case 14:t.prev=14,t.t0=t["catch"](0),e.isProcessing=!1,p["a"].fire({icon:"error",title:"無法跟隨，請稍後再試"});case 18:case"end":return t.stop()}}),t,null,[[0,14]])})))()},linkToUserProfile:function(e){this.$router.push("/users/".concat(e))},postTimeline:function(e,t,s){this.$socket.emit("post_timeline",{ReceiverId:e,type:t,PostId:s})}}},v=m,h=(s("5fae"),s("2877")),b=Object(h["a"])(v,u,f,!1,null,"2ac7495d",null),U=b.exports,k={components:{Headbar:a["a"],Sidebar:l["a"],UsersTop:c["a"],UserFollowingsCard:U},data:function(){return{user:{id:-1,account:"",name:"",email:"",introduction:"",avatar:"",cover:"",tweetNum:-1,likeNum:-1,followingNum:-1,followerNum:-1,lastLoginAt:-1,isFollowing:!1},followingUsers:[]}},created:function(){var e=this.$route.params.id;this.fetchUser(e),this.fetchFollowingusers(e)},beforeRouteUpdate:function(e,t,s){var i=e.params.id;this.fetchUser(i),this.fetchFollowingusers(i),s()},methods:{fetchUser:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function s(){var i,r,n,o,a,l,c,u,f,w,g,m,v,h,b;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,d["a"].getUser({userId:e});case 3:i=s.sent,r=i.data,n=r.id,o=r.account,a=r.name,l=r.email,c=r.introduction,u=r.avatar,f=r.cover,w=r.tweetNum,g=r.likeNum,m=r.followingNum,v=r.followerNum,h=r.lastLoginAt,b=r.isFollowing,t.user={id:n,account:o,name:a,email:l,introduction:c,avatar:u,cover:f,tweetNum:w,likeNum:g,followingNum:m,followerNum:v,lastLoginAt:h,isFollowing:b},s.next=13;break;case 9:s.prev=9,s.t0=s["catch"](0),console.log(s.t0),p["a"].fire({icon:"error",title:"無法取得使用者資料，請稍後再試"});case 13:case"end":return s.stop()}}),s,null,[[0,9]])})))()},fetchFollowingusers:function(e){var t=this;return Object(o["a"])(regeneratorRuntime.mark((function s(){var i;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.prev=0,s.next=3,d["a"].getFollowings({userId:e,offset:0,limit:100});case 3:i=s.sent,t.followingUsers=Object(n["a"])({},i.data),s.next=10;break;case 7:s.prev=7,s.t0=s["catch"](0),p["a"].fire({icon:"warning",title:"無法取得正在跟隨清單，請稍後再試"});case 10:case"end":return s.stop()}}),s,null,[[0,7]])})))()}}},C=k,_=(s("4aa9"),Object(h["a"])(C,i,r,!1,null,"e7f6818a",null));t["default"]=_.exports}}]);
//# sourceMappingURL=chunk-54b9b808.e337f1fd.js.map