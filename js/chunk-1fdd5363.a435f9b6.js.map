{"version":3,"sources":["webpack:///./src/views/PrivateMessage.vue?f861","webpack:///./src/components/UserRooms.vue?ded4","webpack:///./src/assets/img/icon_send.svg","webpack:///./src/components/PrivateChatroom.vue?0448","webpack:///./src/views/PrivateMessage.vue?fd00","webpack:///./src/components/UserRooms.vue?511a","webpack:///src/components/UserRooms.vue","webpack:///./src/components/UserRooms.vue?cf00","webpack:///./src/components/UserRooms.vue","webpack:///./src/components/PrivateChatroom.vue?c816","webpack:///src/components/PrivateChatroom.vue","webpack:///./src/components/PrivateChatroom.vue?3648","webpack:///./src/components/PrivateChatroom.vue","webpack:///src/views/PrivateMessage.vue","webpack:///./src/views/PrivateMessage.vue?9d1e","webpack:///./src/views/PrivateMessage.vue","webpack:///./src/assets/img/icon_mail-add.svg"],"names":["module","exports","render","_vm","this","_h","$createElement","_c","_self","staticClass","ref","on","$event","userRoomsHandleScroll","_v","attrs","showModal","_e","_l","user","key","id","afterClickUserRoom","userRoomsLimit","directives","name","rawName","value","currentRoom","expression","_s","account","messages","messageLoadMore","afterPostMsg","afterScrollTop","afterShowUserListModal","cancelModal","msgUsersFollowing","length","joinUserRoomAwait","_f","avatar","refInFor","preventDefault","stopPropagation","joinUserRoomConfirm","msgUsersUnFollowing","staticRenderFns","roomMember","class","lastMsg","content","fromRoomMember","createdAt","unreadNum","linked","isLinked","handleCLickUserRoom","mixins","props","initialUser","type","Object","required","data","computed","watch","created","fetchUser","methods","$emit","component","showLoadMore","handleScroll","initialCurrentRoom","showUserListModal","loadMoreLimit","msg","domProps","indexOf","_k","keyCode","postPrivateMsg","apply","arguments","target","composing","text","initialMessages","Array","initialMessageLoadMore","Number","socket","privateRoom","memberNum","isSelf","isLoading","isPostMsg","setTimeout","updateScroll","$refs","scrollHeight","updated","sockets","get_private_msg","push","$socket","emit","SenderId","currentUser","ReceiverId","userId","RoomId","icon","title","scrollTop","heightPoint","e","srcElement","loadMore","components","Sidebar","UserRooms","PrivateChatroom","Spinner","userRooms","userRoomAwait","privateRoomAwait","getPrivateRoomId","msgUnseenNum","msgUnseenRooms","msgUnreadRooms","isShowModal","joinPrivateRoom","getPrivateHistory","localStorage","setItem","JSON","stringify","$router","userRoomId","checkPastMsg","handleUserRoomAwait","unshift","map","joinPrivatePage","catchUserRoomId","getItem","fetchMsgUsers","join_private_room","get_msg_notice_details","unseenRooms","unreadRooms","update_msg_notice_details","messageNotice","removeItem","getPrivateRooms","offset","limit","roomId","parse","Date","awaitMsg","offsetHeight","joinUserRoomAwaitToFalse","leavePrivatePage","beforeDestroy"],"mappings":"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","file":"js/chunk-1fdd5363.a435f9b6.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PrivateMessage.vue?vue&type=style&index=0&id=291bcd40&scoped=true&lang=css&\"","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserRooms.vue?vue&type=style&index=0&id=094a6154&scoped=true&lang=css&\"","module.exports = __webpack_public_path__ + \"img/icon_send.2d406717.svg\";","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PrivateChatroom.vue?vue&type=style&index=0&id=68e430c7&scoped=true&lang=css&\"","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"container private-message\"},[_c('Sidebar'),_c('div',{staticClass:\"private-message-wrap\"},[_c('section',{staticClass:\"private-users\"},[_c('div',{ref:\"userRoomsList\",staticClass:\"private-users-wrap\",on:{\"scroll\":function($event){return _vm.userRoomsHandleScroll($event)}}},[_c('h2',{staticClass:\"headbar\"},[_c('div',{staticClass:\"title\"},[_c('div',{staticClass:\"main-title\"},[_vm._v(\"訊息\")]),_c('div',{staticClass:\"add-msg-user\",attrs:{\"data-toggle\":\"modal\",\"data-target\":\"#newMessageModal\"},on:{\"click\":_vm.showModal}},[_c('img',{attrs:{\"src\":require(\"@/assets/img/icon_mail-add.svg\"),\"width\":\"30px\",\"alt\":\"\"}})])])]),_c('ul',{staticClass:\"private-users-list\"},[(_vm.isLoading)?_c('Spinner'):_vm._e(),_vm._l((_vm.userRooms),function(user){return _c('UserRooms',{key:user.id,attrs:{\"initialUser\":user},on:{\"after-click-user-room\":_vm.afterClickUserRoom}})}),(_vm.userRoomsLimit === 'limited')?_c('li',{staticClass:\"limited\"},[_vm._v(\" 已載入所有聊天室！ \")]):_vm._e()],2)])]),_c('section',{staticClass:\"private-chatroom\"},[_c('div',{staticClass:\"private-chatroom-wrap\"},[_c('h2',{staticClass:\"headbar\"},[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.currentRoom.name),expression:\"currentRoom.name\"}],staticClass:\"title\"},[_c('div',{staticClass:\"main-title\"},[_vm._v(_vm._s(_vm.currentRoom.name))]),_c('div',{staticClass:\"sub-title\"},[_vm._v(\"@\"+_vm._s(_vm.currentRoom.account))])])]),_c('div',{staticClass:\"private-chatroomCard\"},[_c('PrivateChatroom',{attrs:{\"initialCurrentRoom\":_vm.currentRoom,\"initialMessages\":_vm.messages,\"initialMessageLoadMore\":_vm.messageLoadMore},on:{\"after-post-msg\":_vm.afterPostMsg,\"after-scroll-top\":_vm.afterScrollTop,\"after-show-user-list-modal\":_vm.afterShowUserListModal}})],1)])])]),(_vm.isShowModal)?_c('div',{staticClass:\"modal fade\",attrs:{\"id\":\"newMessageModal\",\"data-backdrop\":\"static\",\"data-keyboard\":\"false\",\"tabindex\":\"-1\",\"aria-labelledby\":\"newMessageModalLabel\",\"aria-hidden\":\"true\"}},[_c('div',{staticClass:\"modal-dialog\"},[_c('div',{staticClass:\"modal-content\"},[_c('div',{staticClass:\"modal-header\"},[_c('button',{staticClass:\"close\",attrs:{\"type\":\"button\",\"data-dismiss\":\"modal\",\"aria-label\":\"Close\"},on:{\"click\":_vm.cancelModal}},[_c('img',{attrs:{\"src\":require(\"@/assets/img/icon_close-og.svg\"),\"alt\":\"\"}})]),_c('span',[_vm._v(\"新訊息\")])]),_c('div',{staticClass:\"modal-body\"},[_c('form',{staticClass:\"create-tweet\",attrs:{\"action\":\"\"}},[_c('ul',{staticClass:\"message-users\"},[(_vm.msgUsersFollowing.length > 0)?_c('li',{staticClass:\"following\"},[_vm._v(\"正在跟隨的使用者\")]):_vm._e(),_vm._l((_vm.msgUsersFollowing),function(user){return _c('li',{key:user.id,staticClass:\"message-user\",on:{\"click\":function($event){return _vm.joinUserRoomAwait(user)}}},[_c('div',{staticClass:\"avatar\"},[_c('img',{attrs:{\"src\":_vm._f(\"emptyImage\")(user.avatar),\"alt\":\"\"}})]),_c('div',{staticClass:\"user-info\"},[_c('span',{ref:\"\",refInFor:true,staticClass:\"name\"},[_vm._v(_vm._s(user.name))]),_c('span',{staticClass:\"account\"},[_vm._v(\"@\"+_vm._s(user.account))])]),(user.joinUserRoomAwait)?_c('button',{staticClass:\"btn\",on:{\"click\":function($event){$event.preventDefault();$event.stopPropagation();return _vm.joinUserRoomConfirm(user)}}},[_vm._v(\"開始聊天\")]):_vm._e()])}),(_vm.msgUsersUnFollowing.length > 0)?_c('li',{staticClass:\"un-following\"},[_vm._v(\"其他未跟隨的使用者\")]):_vm._e(),_vm._l((_vm.msgUsersUnFollowing),function(user){return _c('li',{key:user.id,staticClass:\"message-user\",on:{\"click\":function($event){return _vm.joinUserRoomAwait(user)}}},[_c('div',{staticClass:\"avatar\"},[_c('img',{attrs:{\"src\":_vm._f(\"emptyImage\")(user.avatar),\"alt\":\"\"}})]),_c('div',{staticClass:\"user-info\"},[_c('span',{ref:\"\",refInFor:true,staticClass:\"name\"},[_vm._v(_vm._s(user.name))]),_c('span',{staticClass:\"account\"},[_vm._v(\"@\"+_vm._s(user.account))])]),(user.joinUserRoomAwait)?_c('button',{staticClass:\"btn\",on:{\"click\":function($event){$event.preventDefault();$event.stopPropagation();return _vm.joinUserRoomConfirm(user)}}},[_vm._v(\"開始聊天\")]):_vm._e()])})],2)])])])])]):_vm._e()],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('li',{staticClass:\"notice\"},[_c('router-link',{staticClass:\"avatar\",attrs:{\"to\":(\"/users/\" + (_vm.user.roomMember.id))}},[_c('img',{attrs:{\"src\":_vm._f(\"emptyImage\")(_vm.user.roomMember.avatar),\"alt\":\"\"}})]),_c('div',{staticClass:\"notice-info\"},[_c('div',{staticClass:\"user-info\"},[_c('router-link',{staticClass:\"name\",attrs:{\"to\":(\"/users/\" + (_vm.user.roomMember.id))}},[_vm._v(\" \"+_vm._s(_vm.user.roomMember.name)+\" \")]),_c('span',{staticClass:\"account\"},[_vm._v(\"@\"+_vm._s(_vm.user.roomMember.account))])],1),_c('div',{staticClass:\"user-msg\",class:{ 'await-msg': _vm.user.lastMsg.content === '立即開啟對話吧 ▸'}},[_c('span',{staticClass:\"last-msg\"},[(!_vm.user.lastMsg.fromRoomMember)?_c('small',[_vm._v(\"你：\")]):_vm._e(),_vm._v(_vm._s(_vm.user.lastMsg.content)+\" \")]),_c('span',{staticClass:\"last-time\"},[_vm._v(_vm._s(_vm._f(\"fromNow\")(_vm.user.lastMsg.createdAt)))]),(_vm.user.unreadNum > 0)?_c('span',{staticClass:\"unread-number\"},[_vm._v(\" \"+_vm._s(_vm.user.unreadNum)+\" \")]):_vm._e()])]),_c('div',{staticClass:\"full-link\",class:{ linked: _vm.user.isLinked },on:{\"click\":_vm.handleCLickUserRoom}})],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <li class=\"notice\">\n      <!-- :class=\"{ 'new-user-room': user.newUserRoom }\" -->\n      <router-link\n        class=\"avatar\"\n        :to=\"`/users/${user.roomMember.id}`\"\n      >\n        <img :src=\"user.roomMember.avatar | emptyImage\" alt=\"\">\n      </router-link>\n      <div class=\"notice-info\">\n        <div class=\"user-info\">\n          <router-link\n            class=\"name\"\n            :to=\"`/users/${user.roomMember.id}`\"\n          >\n            {{ user.roomMember.name }}\n          </router-link>\n          <span class=\"account\">@{{ user.roomMember.account }}</span>\n        </div>\n        <div class=\"user-msg\" :class=\"{ 'await-msg': user.lastMsg.content === '立即開啟對話吧 ▸'}\">\n          <span class=\"last-msg\">\n            <small v-if=\"!user.lastMsg.fromRoomMember\">你：</small>{{ user.lastMsg.content }}\n          </span>\n          <span class=\"last-time\">{{ user.lastMsg.createdAt | fromNow }}</span>\n          <span \n            v-if=\"user.unreadNum > 0\" \n            class=\"unread-number\">\n            {{ user.unreadNum }}\n          </span>\n        </div>\n      </div>\n      <!-- :to=\"{ name: 'message-await', params: { id: user.id } }\" -->\n      <div \n        class=\"full-link\"\n        :class=\"{ linked: user.isLinked }\"\n        @click=\"handleCLickUserRoom\"\n      >\n      </div>\n    </li>\n</template>\n<script>\nimport { emptyImageFilter } from \"../utils/mixins\";\nimport { fromNowFilter } from '../utils/mixins'\nimport { mapState } from 'vuex'\n\nexport default {\n  name: 'UserRooms',\n  mixins: [fromNowFilter,emptyImageFilter],\n  props: {\n    initialUser: {\n      type: Object,\n      required: true\n    }\n  },\n  data () {\n    return {\n      user: {}\n    }\n  },\n  computed: {\n    ...mapState(['currentUser'])\n  },\n  watch: {\n    initialUser () {\n      this.user = this.initialUser\n    },\n  },\n  created () {\n    this.fetchUser()\n  },\n  methods: {\n    handleCLickUserRoom() {\n      this.user.unreadNum = 0\n      this.$emit('after-click-user-room', this.user)\n    },\n    fetchUser() {\n      this.user = this.initialUser\n    }\n  }\n}\n</script>\n<style scoped>\n.notice {\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 10px 15px;\n  width: 100%;\n  border-bottom: 1px solid #e6ecf0;\n}\n.avatar {\n  position: relative;\n  z-index: 1;\n}\n.notice-info {\n  position: relative;\n  z-index: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  width: calc( 100% - 50px);\n  text-align: left;\n  pointer-events: none;\n}\n.avatar:hover ~ .full-link,\n.notice-info:hover + .full-link {\n  background-color: #F5F8FA;\n}\n.name {\n  font-weight: bold;\n  pointer-events: visiblefill;\n}\n.notice-content {\n  margin: 10px 0;\n}\n.full-link {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 0;\n}\n.full-link:hover {\n  background-color: #F5F8FA;\n  cursor: pointer;\n  transition: .2s ease-in-out;\n}\n.name:hover {\n  color: #FF6600;\n  text-decoration: none;\n}\n.account {\n  font-size: 14px;\n}\n.last-msg {\n  display: inline-block;\n  max-width: 250px;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space : nowrap;\n}\n.last-time {\n  position: absolute;\n  top: 0;\n  right: 0;\n  font-size: 14px;\n}\n.await-msg .last-msg {\n  color: #ff6600;\n}\n.await-msg .last-time {\n  display: none;\n}\n.unread-number {\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  display: block;\n  min-width: 25px;\n  height: 25px;\n  line-height: 25px;\n  border-radius: 25px;\n  text-align: center;\n  background: #ff6600;\n  color: #fff;\n}\n.full-link {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 0;\n  border-right: 2px solid #fff;\n}\n.full-link:hover,\n.full-link.linked {\n  background-color: #f5f8fa;\n  cursor: pointer;\n}\n.full-link:hover {\n  border-right: 2px solid #f5f8fa;\n  transition: .2s ease-in-out;\n}\n.full-link.linked {\n  border-right: 2px solid #ff6600;\n}\n@media (max-width: 768px) {\n  .PublicMessage .avatar {\n    width: 40px;\n    height: 40px;\n  }\n}\n@media (max-width: 576px) {\n  .PublicMessage .avatar {\n    width: 30px;\n    height: 30px;\n  }\n  .name,\n  .account {\n    font-size: 14px;\n  }\n  .notice-info .user-info {\n    margin-bottom: 0;\n  }\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserRooms.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./UserRooms.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./UserRooms.vue?vue&type=template&id=094a6154&scoped=true&\"\nimport script from \"./UserRooms.vue?vue&type=script&lang=js&\"\nexport * from \"./UserRooms.vue?vue&type=script&lang=js&\"\nimport style0 from \"./UserRooms.vue?vue&type=style&index=0&id=094a6154&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"094a6154\",\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{ref:\"messages\",staticClass:\"chat-wrap\",class:{ 'show-load-more': _vm.showLoadMore },on:{\"scroll\":function($event){return _vm.handleScroll($event)}}},[(!_vm.initialCurrentRoom.name)?_c('div',{staticClass:\"privateroom-await\"},[_c('p',[_vm._v(\"你未選取訊息\")]),_c('span',[_vm._v(\"從你現有的訊息中選擇一則，或開始一則新訊息。\")]),_c('button',{staticClass:\"btn\",attrs:{\"data-toggle\":\"modal\",\"data-target\":\"#newMessageModal\"},on:{\"click\":_vm.showUserListModal}},[_vm._v(\" 新訊息 \")])]):_vm._e(),(_vm.initialCurrentRoom.name)?_c('div',{staticClass:\"chat messages\",attrs:{\"id\":\"messages\"}},[(_vm.loadMoreLimit === 'limited')?_c('div',{staticClass:\"load-text load-limited\"},[_vm._v(\" 沒有更多訊息了！ \")]):_vm._e(),(_vm.showLoadMore)?_c('div',{staticClass:\"load-text load-more\"},[_c('span',{staticClass:\"loading\"}),_c('span',[_vm._v(\"正在載入訊息...\")])]):_vm._e(),_vm._l((_vm.messages),function(msg){return _c('div',{key:msg.id},[(msg.isSelf)?_c('div',{staticClass:\"self msg\"},[_c('p',[_vm._v(\" \"+_vm._s(msg.content)+\" \")]),_c('span',[_vm._v(_vm._s(_vm._f(\"fromNow\")(msg.createdAt)))])]):_c('div',{staticClass:\"other msg\"},[_c('router-link',{staticClass:\"avatar\",attrs:{\"to\":(\"/users/\" + (msg.UserId))}},[_c('img',{attrs:{\"src\":_vm._f(\"emptyImage\")(msg.avatar),\"alt\":\"\"}})]),_c('div',{},[_c('p',[_vm._v(\" \"+_vm._s(msg.content)+\" \")]),_c('span',[_vm._v(_vm._s(_vm._f(\"fromNow\")(msg.createdAt)))])])],1)])})],2):_vm._e(),_c('div',{staticClass:\"d-flex justify-content-center align-items-center send-wrap\"},[(_vm.initialCurrentRoom.name)?[_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.text),expression:\"text\"}],attrs:{\"placeholder\":\"請輸入訊息 ...\",\"type\":\"text\",\"maxlength\":\"160\"},domProps:{\"value\":(_vm.text)},on:{\"keypress\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.postPrivateMsg.apply(null, arguments)},\"input\":function($event){if($event.target.composing){ return; }_vm.text=$event.target.value}}}),_c('button',{staticClass:\"send-btn\",attrs:{\"type\":\"button\"},on:{\"click\":function($event){$event.stopPropagation();$event.preventDefault();return _vm.postPrivateMsg.apply(null, arguments)}}},[_c('img',{attrs:{\"src\":require(\"@/assets/img/icon_send.svg\"),\"alt\":\"\"}})])]:_vm._e()],2)])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div \n    class=\"chat-wrap\" \n    :class=\"{ 'show-load-more': showLoadMore }\"\n    ref=\"messages\" \n    @scroll=\"handleScroll($event)\"\n    >\n    <div\n      v-if=\"!initialCurrentRoom.name\"\n      class=\"privateroom-await\">\n      <p>你未選取訊息</p>\n      <span>從你現有的訊息中選擇一則，或開始一則新訊息。</span>\n      <button \n        class=\"btn\" \n        @click=\"showUserListModal\" \n        data-toggle=\"modal\" \n        data-target=\"#newMessageModal\">\n        新訊息\n      </button>\n    </div>\n    <div \n      v-if=\"initialCurrentRoom.name\"\n      class=\"chat messages\" id=\"messages\">\n      <div v-if=\"loadMoreLimit === 'limited'\" class=\"load-text load-limited\">\n        沒有更多訊息了！\n      </div>\n      <div v-if=\"showLoadMore\" class=\"load-text load-more\">\n        <span class=\"loading\"></span><span>正在載入訊息...</span>\n      </div>\n      <div v-for=\"msg in messages\" :key=\"msg.id\" class=\"\" >\n        <div \n          v-if=\"msg.isSelf\"\n          class=\"self msg\" >\n          <p>\n            {{ msg.content }}\n          </p>\n          <span>{{ msg.createdAt | fromNow }}</span>\n        </div>\n        <div \n          v-else\n          class=\"other msg\">\n          <router-link :to=\"`/users/${msg.UserId}`\" class=\"avatar\">\n            <img :src=\"msg.avatar | emptyImage\" alt=\"\">\n          </router-link>\n          <div class=\"\">\n            <p>\n              {{ msg.content }}\n            </p>\n            <span>{{ msg.createdAt | fromNow }}</span>\n          </div>\n        </div> \n      </div>\n    </div>\n    <div class=\"d-flex justify-content-center align-items-center send-wrap\">\n      <template v-if=\"initialCurrentRoom.name\">\n        <input \n          v-model=\"text\"\n          placeholder=\"請輸入訊息 ...\"\n          type=\"text\"\n          maxlength=\"160\"\n          @keypress.enter=\"postPrivateMsg\"\n        >\n        <button \n          class=\"send-btn\"\n          type=\"button\"\n          @click.stop.prevent=\"postPrivateMsg\"\n        >\n          <img src=\"~@/assets/img/icon_send.svg\" alt=\"\">\n        </button>\n      </template>\n    </div>\n  </div>\n</template>\n<script>\nimport { mapState } from 'vuex'\nimport { Toast } from './../utils/helpers'\nimport { emptyImageFilter } from \"../utils/mixins\"\nimport { fromNowFilter } from './../utils/mixins'\n\nexport default {\n  name: 'PrivateChatroom',\n  mixins: [fromNowFilter,emptyImageFilter],\n  props: {\n    initialCurrentRoom: {\n      type: Object,\n      required: true\n    },\n    initialMessages: {\n      type: Array,\n      required: true\n    },\n    initialMessageLoadMore: {\n      type: Number,\n      required: true\n    }\n  },\n  data () {\n    return {\n      socket: null,\n      privateRoom: {},\n      text: '',\n      memberNum: 0, \n      messages: [],\n      loadMoreLimit: 20,\n      showLoadMore: false,\n      isSelf: false,\n      isLoading: true,\n      isPostMsg: false\n    }\n  },\n  computed: {\n    ...mapState(['currentUser'])\n  },\n  watch: {\n    initialCurrentRoom() {\n      this.privateRoom = this.initialCurrentRoom\n    },\n    initialMessages() {\n      this.messages = this.initialMessages\n    },\n    initialMessageLoadMore () {\n      this.loadMoreLimit = this.initialMessageLoadMore\n    },\n    isPostMsg(value) {\n      if (value) {\n        setTimeout(() => { \n          this.text = ''\n        }, 500)\n      }\n    },\n    text(value) {\n      if (value === '' && this.isPostMsg) {\n        this.updateScroll(this.$refs.messages.scrollHeight)\n        this.isPostMsg = false\n      }\n    },\n    loadMoreLimit (value) {\n      if (value === 'limited') {\n        setTimeout(() => { \n          this.loadMoreLimit = 'nomore'\n        }, 3000)\n      } \n    },\n    showLoadMore(value) {\n      if (value) {\n        setTimeout(() => { \n          this.showLoadMore = false\n        }, 2500)\n      }\n    }\n  },\n  updated () {\n    if (this.loadMoreLimit === 20) {\n      this.updateScroll(this.$refs.messages.scrollHeight)\n    }\n  },\n  sockets: {\n    get_private_msg(data) {\n      this.messages.push(data)\n    }\n  },\n  methods: {\n    postPrivateMsg() { \n      if (!this.text.length) {\n        Toast.fire({\n          icon: 'warning',\n          title: '你還沒有填寫訊息'\n        })\n        return\n      }\n      this.$socket.emit('post_private_msg', { \n        SenderId: this.currentUser.id,\n        ReceiverId: this.privateRoom.userId,\n        RoomId: this.privateRoom.id,\n        content: this.text,\n      })\n      \n      const avatar = this.currentUser.avatar\n      const content = this.text\n      const createdAt = new Date()\n      const data = {\n        avatar,\n        content,\n        createdAt,\n        isSelf: true\n      }\n      this.messages.push( data )\n      this.$emit('after-post-msg', this.text)\n      this.isPostMsg = true\n    },\n    updateScroll(heightPoint) {\n      this.$refs.messages.scrollTop = heightPoint\n    },\n    handleScroll(e) {\n      if (e.srcElement.scrollTop === 0 ) {\n        this.loadMore()\n      }\n      if (this.loadMoreLimit === 'nomore') {\n        this.loadMoreLimit = 'limited'\n      }\n    },\n    loadMore() {\n      if (this.messages.length >= this.loadMoreLimit) {\n        this.showLoadMore = true\n\n        const limit = this.messages.length + 5\n        setTimeout(() => { \n          this.$emit('after-scroll-top', limit)\n          this.loadMoreLimit = limit\n        }, 2000)\n        \n      } else if (this.loadMoreLimit - this.messages.length <= 5){\n        this.loadMoreLimit = 'limited'\n      }\n    },\n    showUserListModal() {\n      this.$emit('after-show-user-list-modal')\n    }\n  }\n}\n</script>\n<style scoped>\n.chat-wrap {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: calc( 100vh - 110px);\n  overflow-y: scroll;\n  overscroll-behavior-y: contain;\n  box-sizing: border-box;\n}\n.chat::-webkit-scrollbar {\n  display: none;\n}\n.messages {\n  width: 100%;\n  height: 100%;\n}\n.chat > div{\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-end;\n  align-items: center;\n  width: 100%;\n  /* height: 100%; */\n  margin: 0 auto;\n  padding: 15px;\n}\n.other {\n  align-self: flex-start;\n  display: flex;\n  align-items: flex-end;\n  margin-bottom: 10px;\n}\n.self {\n  text-align: right;\n  align-self: flex-end;\n  margin-bottom: 10px;\n}\n.other > div {\n  text-align: left;\n}\n.msg p {\n  width: auto;\n  max-width: 400px;\n  padding: 15px 20px;\n  margin-bottom: 0;\n  font-size: 20px;\n}\n.msg span {\n  font-size: 13px;\n  color: #6f767a;\n}\n.other a {\n  margin-bottom: 23px;\n}\n.other p {\n  background: #e6edf1;\n  border-radius: 20px 20px 20px 0;\n}\n.self p {\n  color: #fff;\n  background: #ff6600;\n  border-radius: 20px 20px 0 20px;\n}\n.user_join {\n  background: #ccc;\n  padding: 5px 15px;\n  margin: 0;\n  border-radius: 50px;\n}\n.send-wrap {\n  position: absolute;\n  bottom: 0;\n  align-items: center;\n  width: 100%;\n  height: 100%;\n  max-height: 60px;\n  padding: 10px;\n  box-sizing: border-box;\n  border-width: 1px 0;\n  border-style: solid;\n  border-color: #e6ecf0;\n  background: #fff;\n}\ninput {\n    width: 100%;\n    height: 35px;\n    padding-left: 20px;\n    border: 1px solid #dde3e6;\n    border-radius: 30px;\n    background: #d5dee3;\n    outline: none;\n}\n.send-btn {\n      width: auto;\n    margin: 0 20px;\n}\n.send-btn img {\n  width: 20px;\n  filter: invert(73%) sepia(100%) saturate(48) hue-rotate(364deg);\n  transition: .3s ease-in-out;\n}\n.send-btn:hover img {\n  transform: scale(1.2);\n  transition: .3s ease-in-out;\n}\n.privateroom-await p {\n  margin-bottom: 5px;\n  font-size: 24px;\n  font-weight: bold;\n}\n.privateroom-await span {\n  display: block;\n  margin-bottom: 10px;\n}\n.privateroom-await .btn {\n  color: #fff;\n  background-color: #ff6600;\n}\n.chat > .load-more {\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n  color: #fdaa72;\n}\n.loading {\n  height: 15px;\n  width: 15px;\n  border-radius: 100%;\n  margin: 6px;\n  border: 2px solid #fdaa72;\n  border-bottom-color: transparent;\n  vertical-align: middle;\n  -webkit-animation: rotate 0.75s linear infinite;\n  animation: rotate 0.75s linear infinite;\n}\n.load-more span:last-child {\n  padding-top: 5px;\n}\n.load-limited {\n  color: #ccc;\n}\n.show-load-more {\n  overflow-y: hidden;\n}\n@keyframes rotate {\n  0% {\n      -webkit-transform: rotate(0deg);\n  }\n  100% {\n      -webkit-transform: rotate(360deg);\n  }\n}\n@media (max-width: 576px) {\n  .chat {\n    margin-bottom: 10vh;\n  }\n  .msg p {\n    max-width: 180px;\n    font-size: 14px;\n  }\n  .privateroom-await span {\n    max-width: 250px;\n  }\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PrivateChatroom.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PrivateChatroom.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PrivateChatroom.vue?vue&type=template&id=68e430c7&scoped=true&\"\nimport script from \"./PrivateChatroom.vue?vue&type=script&lang=js&\"\nexport * from \"./PrivateChatroom.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PrivateChatroom.vue?vue&type=style&index=0&id=68e430c7&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"68e430c7\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"container private-message\">\n    <Sidebar /> \n    <div class=\"private-message-wrap\">\n      <section class=\"private-users\">\n        <div class=\"private-users-wrap\" ref=\"userRoomsList\" @scroll=\"userRoomsHandleScroll($event)\">\n          <h2 class=\"headbar\">\n            <div class=\"title\">\n              <div class=\"main-title\">訊息</div>\n              <div \n                class=\"add-msg-user\"\n                data-toggle=\"modal\"\n                data-target=\"#newMessageModal\"\n                @click=\"showModal\">\n                <img src=\"~@/assets/img/icon_mail-add.svg\" width=\"30px\" alt=\"\" />\n              </div>\n            </div>\n          </h2>\n          <ul\n            class=\"private-users-list\">\n            <Spinner v-if=\"isLoading\"/>\n            <UserRooms\n              v-for=\"user in userRooms\"\n              :key=\"user.id\"\n              :initialUser=\"user\" \n              @after-click-user-room=\"afterClickUserRoom\"\n            />\n            <li v-if=\"userRoomsLimit === 'limited'\" class=\"limited\">\n              已載入所有聊天室！\n            </li>\n          </ul>\n        </div>\n      </section>\n      <section class=\"private-chatroom\">\n        <div class=\"private-chatroom-wrap\">\n          <h2 class=\"headbar\">\n            <div\n              v-show=\"currentRoom.name\" \n              class=\"title\">\n              <div class=\"main-title\">{{ currentRoom.name }}</div>\n              <div class=\"sub-title\">@{{ currentRoom.account }}</div>\n            </div>\n          </h2>\n          <div\n            class=\"private-chatroomCard\">\n            <PrivateChatroom \n              :initialCurrentRoom=\"currentRoom\"\n              :initialMessages=\"messages\"\n              :initialMessageLoadMore=\"messageLoadMore\"\n              @after-post-msg=\"afterPostMsg\"\n              @after-scroll-top=\"afterScrollTop\"\n              @after-show-user-list-modal=\"afterShowUserListModal\"\n            />\n          </div>\n        </div>\n      </section>\n    </div>\n    <!-- Button trigger modal -->\n    <div\n      v-if=\"isShowModal\"\n      class=\"modal fade\"\n      id=\"newMessageModal\"\n      data-backdrop=\"static\" \n      data-keyboard=\"false\" \n      tabindex=\"-1\"\n      aria-labelledby=\"newMessageModalLabel\"\n      aria-hidden=\"true\"\n    >\n      <!-- Modal -->\n      <div class=\"modal-dialog\">\n        <div class=\"modal-content\">\n          <div class=\"modal-header\">\n            <button\n              type=\"button\"\n              class=\"close\"\n              data-dismiss=\"modal\"\n              aria-label=\"Close\"\n              @click=\"cancelModal\"\n            >\n              <img src=\"~@/assets/img/icon_close-og.svg\" alt=\"\" />\n            </button>\n            <span>新訊息</span>\n          </div>\n          <div class=\"modal-body\">\n            <form class=\"create-tweet\" action=\"\">\n              <ul class=\"message-users\">\n                <li v-if=\"msgUsersFollowing.length > 0\" class=\"following\">正在跟隨的使用者</li>\n                <li \n                  v-for=\"user of msgUsersFollowing\" \n                  :key=\"user.id\" \n                  class=\"message-user\"\n                  @click=\"joinUserRoomAwait(user)\">\n                  <div class=\"avatar\">\n                    <img :src=\"user.avatar | emptyImage\" alt=\"\">\n                  </div>\n                  <div class=\"user-info\">\n                    <span ref=\"\" class=\"name\">{{ user.name }}</span>\n                    <span class=\"account\">@{{ user.account }}</span>\n                  </div>\n                  <button v-if=\"user.joinUserRoomAwait\" class=\"btn\" @click.prevent.stop=\"joinUserRoomConfirm(user)\">開始聊天</button>\n                </li>\n                <li v-if=\"msgUsersUnFollowing.length > 0\" class=\"un-following\">其他未跟隨的使用者</li>\n                <li \n                  v-for=\"user of msgUsersUnFollowing\" \n                  :key=\"user.id\" \n                  class=\"message-user\"\n                  @click=\"joinUserRoomAwait(user)\">\n                  <div class=\"avatar\">\n                    <img :src=\"user.avatar | emptyImage\" alt=\"\">\n                  </div>\n                  <div class=\"user-info\">\n                    <span ref=\"\" class=\"name\">{{ user.name }}</span>\n                    <span class=\"account\">@{{ user.account }}</span>\n                  </div>\n                  <button v-if=\"user.joinUserRoomAwait\" class=\"btn\" @click.prevent.stop=\"joinUserRoomConfirm(user)\">開始聊天</button>\n                </li>\n              </ul>\n            </form>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\nimport { mapState } from 'vuex'\nimport { emptyImageFilter } from \"../utils/mixins\"\nimport { Toast } from \"./../utils/helpers\"\nimport usersAPI from \"../apis/users\"\nimport Sidebar from \"./../components/Sidebar.vue\"\nimport UserRooms from \"./../components/UserRooms.vue\"\nimport PrivateChatroom from \"./../components/PrivateChatroom.vue\"\nimport Spinner from './../components/Spinner'\nimport $ from 'jquery'\n\nexport default {\n  name: 'PrivateMessage',\n  mixins: [emptyImageFilter],\n  components: {\n    Sidebar,\n    UserRooms,\n    PrivateChatroom,\n    Spinner\n  },\n  data() {\n    return {\n      socket: null,\n      userRooms: [],\n      userRoomsLimit: 100,\n      currentRoom: {},\n      userRoomAwait: {},\n      privateRoomAwait: {},\n      getPrivateRoomId: 0,\n      messages: [],\n      messageLoadMore: 0,\n      msgUnseenNum: 0,\n      msgUnseenRooms: [],\n      msgUnreadRooms: [],\n      msgUsersFollowing: [],\n      msgUsersUnFollowing: [],\n      isLoading: true,\n      isShowModal: false\n    }\n  }, \n  computed: {\n    ...mapState(['currentUser'])\n  },\n  watch: {\n    privateRoomAwait() {\n      this.currentRoom = this.privateRoomAwait\n      const User1Id = this.currentUser.id\n      const User2Id = this.currentRoom.userId\n      const RoomId = this.currentRoom.id\n\n      this.joinPrivateRoom({ User1Id, User2Id, RoomId })\n      this.getPrivateHistory(RoomId, 20)\n    },\n    msgUnreadRooms() {\n      for (let i = 0; i < this.msgUnreadRooms.length; i++) {\n        this.userRooms = this.userRooms.map( user => {\n          const { id, lastMsg, roomMember, isLinked } = user\n          const unreadNum = user.roomMember.id === this.msgUnreadRooms[i].SenderId ? this.msgUnreadRooms[i].unreadNum : user.unreadNum\n          return { id, lastMsg, roomMember, isLinked, unreadNum }\n        })\n      }\n    },\n    getPrivateRoomId() {\n      this.currentRoom.id = this.getPrivateRoomId\n      this.privateRoomAwait = this.currentRoom\n      localStorage.setItem('privateRoomAwait', JSON.stringify(this.privateRoomAwait))\n\n      this.$router.push({ name: 'message-await', params: { id: this.getPrivateRoomId } })\n\n      if (this.userRooms.length <= 0) return\n\n      const userRoomId = Number(this.$route.params.id)\n      const checkPastMsg = this.userRooms.every( user => {\n        return user.id !== userRoomId\n      })\n      if (checkPastMsg && userRoomId) {\n        this.handleUserRoomAwait('立即開啟對話吧 ▸')\n        this.userRooms.unshift(this.userRoomAwait)\n      }\n\n      this.userRooms = this.userRooms.map((user) => {\n        if(user.id === this.currentRoom.id) {\n          user.isLinked = true\n        } else {\n          user.isLinked = false\n        }\n        return user\n      })\n    }\n  },\n  created() {\n    this.joinPrivatePage(this.currentUser.id)\n    this.catchUserRoomId()\n    this.msgUnseenNum = localStorage.getItem('msgUnseenNum')\n    this.fetchMsgUsers(this.currentUser.id) \n  },\n  sockets: {\n    join_private_room(RoomId) {\n      this.getPrivateRoomId = RoomId\n    },\n    get_msg_notice_details({ unseenRooms, unreadRooms }) {\n      this.msgUnseenRooms = unseenRooms\n      this.msgUnreadRooms = unreadRooms\n    },\n    update_msg_notice_details(data) {\n      this.messageNotice = data\n      this.userRooms = this.userRooms.map( user => {\n        if (user.id === this.messageNotice.id) {\n          user.lastMsg.fromRoomMember = true\n          user.lastMsg.content = this.messageNotice.lastMsg.content\n          user.lastMsg.createdAt = this.messageNotice.lastMsg.createdAt\n          user.unreadNum = this.messageNotice.unreadNum\n        }\n        return user\n      })\n    },\n    get_private_msg(data) {\n      this.userRooms = this.userRooms.map((user) => {\n        if(user.id === this.currentRoom.id) {\n          user.lastMsg.fromRoomMember = true\n          user.lastMsg.content = data.content\n          user.lastMsg.createdAt = data.createdAt\n        }\n        return user\n      })\n    }\n  },\n  methods: {\n    joinPrivatePage(userId) { \n      this.$socket.emit('join_private_page', { userId })\n      localStorage.removeItem('msgUnseenNum')\n      this.getPrivateRooms(0, this.userRoomsLimit)\n    },\n    getPrivateRooms(offset, limit) {\n      this.$socket.emit('get_private_rooms', {\n        offset,\n        limit\n        }, data => {\n          this.userRooms = data.map( user => {\n            const { id, lastMsg, roomMember } = user\n            const isLinked = id === this.currentRoom.id ? true : false\n            return { id, lastMsg, roomMember, isLinked }\n          })\n          \n          const userRoomId = Number(this.$route.params.id)\n          const checkPastMsg = this.userRooms.every( user => {\n            return user.id !== userRoomId\n          })\n          if (checkPastMsg && userRoomId) {\n            this.handleUserRoomAwait('立即開啟對話吧 ▸')\n            this.userRooms.unshift(this.userRoomAwait)\n          }\n\n          if (this.msgUnreadRooms.length > 0) {\n            for (let i = 0; i < this.msgUnreadRooms.length; i++) {\n              this.userRooms = this.userRooms.map( user => {\n                const { id, lastMsg, roomMember, isLinked } = user\n                const unreadNum = user.roomMember.id === this.msgUnreadRooms[i].SenderId ? this.msgUnreadRooms[i].unreadNum : user.unreadNum\n                return { id, lastMsg, roomMember, isLinked, unreadNum }\n              })\n            }\n          }\n          this.isLoading = false\n        }\n      )\n    },\n    joinPrivateRoom({ User1Id, User2Id, RoomId }) { \n      this.$socket.emit('join_private_room', { User1Id, User2Id, RoomId })\n    },\n    afterClickUserRoom(user) {\n      this.userRoomAwait = {}\n\n      this.currentRoom = {\n        id: user.id,\n        userId: user.roomMember.id,\n        name: user.roomMember.name,\n        account: user.roomMember.account,\n        avatar: user.roomMember.avatar\n      }\n      this.userRooms = this.userRooms.map((user) => {\n        if(user.id === this.currentRoom.id) {\n          user.isLinked = true\n        } else {\n          user.isLinked = false\n        }\n        return user\n      })\n      this.messageLoadMore = 20\n\n      this.privateRoomAwait = this.currentRoom\n      localStorage.setItem('privateRoomAwait', JSON.stringify(this.privateRoomAwait))\n      this.$router.push({ name: 'message-await', params: { id: this.currentRoom.id } })\n    },\n    getPrivateHistory(roomId, limit) { \n      this.$socket.emit('get_private_history', {\n        offset: 0,\n        limit: limit,\n        RoomId: roomId,\n      }, data => {\n        this.messages = [\n          ...data.reverse()\n        ]\n        this.messages = this.messages.map( msg => {\n          const { UserId, avatar, content, createdAt } = msg\n          const isSelf = UserId === this.currentUser.id ? true : false\n          return { UserId, avatar, content, createdAt, isSelf }\n        })\n        this.isLoading = false\n      })\n    },\n    catchUserRoomId() {\n      const userRoomId = this.$route.params.id\n      if (!userRoomId) return\n      this.privateRoomAwait = JSON.parse(localStorage.getItem('privateRoomAwait'))\n    },\n    afterPostMsg(content) {\n      this.userRooms = this.userRooms.map((user) => {\n        if(user.id === this.currentRoom.id) {\n          user.lastMsg.fromRoomMember = false\n          user.lastMsg.content = content\n          user.lastMsg.createdAt = new Date()\n        } \n        return user\n      })\n    },\n    handleUserRoomAwait(data) {\n      this.userRoomAwait = {\n        awaitMsg: true,\n        id: this.currentRoom.id,\n        isLinked: true,\n        lastMsg: {\n          content: data,\n          createdAt: '',\n          fromRoomMember: true\n        },\n        roomMember: {\n          account: this.currentRoom.account,\n          avatar: this.currentRoom.avatar,\n          id: this.currentRoom.userId,\n          name: this.currentRoom.name\n        }\n      }\n    },\n    userRoomsHandleScroll(e) {\n      if (e.srcElement.scrollTop + e.srcElement.offsetHeight >= e.srcElement.scrollHeight ) {\n        this.loadMore()\n      }\n    },\n    loadMore() {\n      if (this.userRooms.length >= this.userRoomsLimit) {\n        const offset = 0\n        const limit = this.userRooms.length + 5\n        this.getPrivateRooms(offset, limit)\n        this.userRoomsLimit = limit\n      } else {\n        this.userRoomsLimit = 'limited'\n      }\n    },\n    afterScrollTop(limit) {\n      this.getPrivateHistory(this.currentRoom.id, limit)\n      this.messageLoadMore = limit\n    },\n    async fetchMsgUsers(userId) {\n      try {\n        const responseGetFollowingUsers = await usersAPI.getFollowings({ \n          userId,\n          offset: 0,\n          limit: 50\n        })\n        this.msgUsersFollowing = [ ...responseGetFollowingUsers.data ].map( user => {\n          const { following } = user\n          const msgUser = {\n            id: following.id,\n            account: following.account,\n            name: following.name,\n            avatar: following.avatar,\n            joinUserRoomAwait: false\n          }\n          return msgUser\n        })\n\n        const responseGetOtherUsers = await usersAPI.getTopUsers({\n          offset: 0,\n          limit: 50\n        })\n        this.msgUsersUnFollowing = [...responseGetOtherUsers.data]\n\n      } catch (error) {\n        Toast.fire({\n          icon: \"warning\",\n          title: \"無法取得使用者清單，請稍後再試\",\n        })\n      }\n    },\n    joinUserRoomAwait(msgUser) {\n      this.msgUsersFollowing = this.msgUsersFollowing.map( user => {\n        if(user.id === msgUser.id) {\n          user.joinUserRoomAwait = true\n        } else {\n          user.joinUserRoomAwait = false\n        }\n        return user\n      })\n      this.msgUsersUnFollowing = this.msgUsersUnFollowing.map( user => {\n        if(user.id === msgUser.id) {\n          user.joinUserRoomAwait = true\n        } else {\n          user.joinUserRoomAwait = false\n        }\n        return user\n      })\n    },\n    joinUserRoomConfirm(user) {\n      this.userRoomAwait = {}\n      this.currentRoom = {\n        id: null,\n        userId: user.id,\n        name: user.name,\n        account: user.account,\n        avatar: user.avatar\n      }\n      \n      const User1Id = this.currentUser.id\n      const User2Id = user.id\n      const RoomId = null\n\n      this.$socket.emit('join_private_room', { User1Id, User2Id, RoomId })\n\n      this.joinUserRoomAwaitToFalse()\n      $(`#newMessageModal`).modal(\"hide\")\n    },\n    joinUserRoomAwaitToFalse() {\n      this.msgUsersFollowing = this.msgUsersFollowing.map( user => {\n        const { id, account, name, avatar } = user\n        const joinUserRoomAwait = false\n        return { id, account, name, avatar, joinUserRoomAwait }\n      })\n      this.msgUsersUnFollowing = this.msgUsersUnFollowing.map( user => {\n        const { id, account, name, avatar } = user\n        const joinUserRoomAwait = false\n        return { id, account, name, avatar, joinUserRoomAwait }\n      })\n    },\n    afterShowUserListModal() {\n      this.showModal()\n    },\n    showModal() {\n      this.isShowModal = true\n    },\n    cancelModal() {\n      this.joinUserRoomAwaitToFalse()\n      this.isShowModal = false\n    },\n    leavePrivatePage() {\n      this.$socket.emit('leave_private_page')\n    },\n  },\n  beforeDestroy () {\n    this.leavePrivatePage()\n  }\n}\n</script>\n<style scoped>\n.container {\n  display: grid;\n  grid-template-columns: 20% auto;\n  max-width: 1500px;\n  margin: 0 auto;\n  padding: 0 20px;\n}\n.private-message-wrap {\n  display: flex;\n}\n.private-users {\n  width: 45%;\n}\n.private-chatroom {\n  width: 55%;\n}\n.private-chatroom,\n.private-users {\n  position: relative;\n  margin-top: 50px;\n  border-left: 1px solid #e6ecf0;\n}\n.private-chatroom,\n.private-chatroom .headbar {\n  border-right: 1px solid #e6ecf0;\n}\n.private-users-wrap {\n  max-height: calc(100vh - 50px);\n  /* max-height: 300px; */\n}\n.private-chatroom-wrap {\n  /* overflow-y: auto; */\n  max-height: calc(100vh - 50px);\n}\n.private-users-wrap {\n  overflow-y: scroll;\n}\n.headbar {\n  position: absolute;\n  top: -50px;\n  left: 0;\n  z-index: 10;\n  display: flex;  \n  align-items: center;\n  width: 100%;\n  height: 50px;\n  margin: 0;\n  padding: 5px 20px;\n  font-size: 18px;\n  text-align: left;\n  border-width: 0 0 1px 1px;\n  border-style: solid;\n  border-color: #e6ecf0;\n  background: #fff;\n  transform: translateX(-1px);\n}\n.private-chatroom .headbar {\n  transform: scale(1, 1.004);\n}\n.private-users .title {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  width: 100%;\n}\n.main-title {\n  font-weight: 900;\n}\n.sub-title {\n  font-size: 13px;\n  color: #657786;\n}\n.avatar {\n  display: inline-block;\n}\n.add-msg-user {\n  cursor: pointer;\n}\n.add-msg-user:hover img {\n  filter: invert(73%) sepia(100%) saturate(48) hue-rotate(364deg);\n  /* transition: .2s ease; */\n}\n.private-users-list li.limited {\n  margin: 20px;\n  color: #ccc;\n}\n.modal-content {\n  overflow: hidden;\n}\n.modal-header {\n  justify-content: flex-start;\n  font-size: 18px;\n  font-weight: bold;\n}\n.modal-header span {\n  margin-left: 20px;\n}\n.close {\n  margin: 0;\n  padding: 0;\n  opacity: 1;\n}\n.modal-body {\n  padding: 0;\n}\n.message-users {\n  overflow-y: scroll;\n  height: 80vh;\n  max-height: 800px;\n  margin-bottom: 0;\n}\n.message-users li {\n  position: relative;\n  display: flex;\n  align-items: center;\n  padding: 10px 15px;\n  width: 100%;\n  border-bottom: 1px solid #e6ecf0;\n}\n.message-users li:last-child {\n  border-bottom: none;\n}\n.message-user:hover {\n  background-color: #f5f8fa;\n  cursor: pointer;\n}\n.message-users li .user-info * {\n  display: block;\n  text-align: left;\n}\n.message-users .btn {\n  position: absolute;\n  right: 15px;\n  color: #fff;\n  background-color: #ff6600;\n}\n.message-users .following,\n.message-users .un-following {\n  font-weight: bold;\n}\n.message-users .un-following  {\n  border-top: 9px solid #dce2e6;\n}\n@media (max-width: 992px) {\n  .container {\n    padding-right: 0;\n  }\n  .private-message-wrap {\n    flex-direction: column;\n  }\n  .private-message-wrap section {\n    width: 100%;\n  }\n  .private-users-wrap {\n    height: 20vh;\n  }\n  .chat-wrap {\n    height: calc( 100vh - 20vh - 99px );\n  }\n  .private-chatroom .headbar{\n    border-top: 1px solid #e6ecf0;\n    transform: translateX(-1px);\n  }\n  .new-tweet {\n    display: none;\n  }\n}\n@media (max-width: 576px) {\n  .container {\n    grid-template-columns: 13% auto;\n  }\n}\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PrivateMessage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./PrivateMessage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./PrivateMessage.vue?vue&type=template&id=291bcd40&scoped=true&\"\nimport script from \"./PrivateMessage.vue?vue&type=script&lang=js&\"\nexport * from \"./PrivateMessage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./PrivateMessage.vue?vue&type=style&index=0&id=291bcd40&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"291bcd40\",\n  null\n  \n)\n\nexport default component.exports","module.exports = __webpack_public_path__ + \"img/icon_mail-add.17c0f1f0.svg\";"],"sourceRoot":""}